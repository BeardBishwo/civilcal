# Set default directory index
DirectoryIndex index.php

# MIME Types for proper asset loading
<IfModule mod_mime.c>
    AddType text/css .css
    AddType application/javascript .js
    AddType image/png .png
    AddType image/jpeg .jpg .jpeg
    AddType image/gif .gif
    AddType image/svg+xml .svg
    AddType font/woff .woff
    AddType font/woff2 .woff2
    AddType font/truetype .ttf
    AddType font/opentype .otf
    AddType image/x-icon .ico
</IfModule>

# Security: Block access to sensitive directories and files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block access to sensitive directories
RedirectMatch 403 ^/(app|config|database|storage|vendor|tests)/.*$

<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Redirect /public/ URLs to clean URLs
    RewriteCond %{REQUEST_URI} public
    RewriteRule ^(.*)public/?(.*)$ /$1$2 [R=301,L]
    
    # Serve static files directly
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule .* - [L]
    
    # Route everything else through index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [L,QSA]
</IfModule>