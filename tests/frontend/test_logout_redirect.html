<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logout Auto-Redirect Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .test-section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .result { margin-top: 15px; padding: 15px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #005a8b; }
        .countdown { font-weight: bold; color: #d32f2f; }
    </style>
</head>
<body>
    <h2>üîì Logout Auto-Redirect Test</h2>
    <p>Test the logout page auto-redirect functionality with countdown timer</p>
    
    <div class="test-section">
        <h3>üìù Test Instructions</h3>
        <p>This test simulates the logout page behavior with auto-redirect to homepage:</p>
        <ol>
            <li><strong>Automatic Redirect:</strong> Page will redirect to homepage after 5 seconds</li>
            <li><strong>Countdown Timer:</strong> Visual countdown shows remaining time</li>
            <li><strong>Cancel Option:</strong> Users can cancel the redirect if needed</li>
            <li><strong>Manual Navigation:</strong> Login and Home buttons available</li>
        </ol>
        
        <button onclick="testLogoutPage()">üß™ Test Logout Page</button>
        <button onclick="simulateRedirect()">‚è∞ Simulate Auto-Redirect</button>
        
        <div id="testResults"></div>
    </div>
    
    <div class="test-section">
        <h3>üéØ Auto-Redirect Simulation</h3>
        <div id="simulationArea">
            <div id="logoutSimulation" style="display: none; padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center;">
                <div style="font-size: 2rem; color: #10b981; margin-bottom: 20px;">
                    <i class="fas fa-check-circle">‚úÖ</i>
                </div>
                <h3>Successfully Logged Out</h3>
                <p>You have been safely logged out of your account.<br>Thank you for using Civil Calculator!</p>
                
                <div style="margin: 20px 0;">
                    <button onclick="window.location.href='/'">üè† Go Home</button>
                    <button onclick="window.location.href='/login'">üîë Login Again</button>
                </div>
                
                <div id="redirectNotice" style="display: none; margin-top: 20px; padding: 15px; background: #e0f2fe; border: 1px solid #0288d1; border-radius: 8px;">
                    <span>üïê Redirecting to homepage in <span class="countdown" id="countdown">5</span> seconds...</span>
                    <button onclick="cancelRedirect()" style="background: #f44336; margin-left: 10px;">‚ùå Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h3>üîç Test Results</h3>
        <div id="testOutput">
            <div class="info">
                <h4>‚úÖ Expected Behavior:</h4>
                <ul>
                    <li>Page shows logout success message</li>
                    <li>Auto-redirect notice appears after 2 seconds</li>
                    <li>Countdown timer shows 5, 4, 3, 2, 1</li>
                    <li>Redirect to homepage after countdown completes</li>
                    <li>Cancel button stops the redirect</li>
                    <li>Manual navigation buttons work immediately</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let countdownTime = 5;
        let redirectTimer;
        let countdownInterval;
        
        function testLogoutPage() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = `
                <div class="success">
                    <h4>üß™ Logout Page Test</h4>
                    <p><strong>‚úÖ Auto-redirect functionality added successfully!</strong></p>
                    <ul>
                        <li>‚úÖ Countdown timer: 5 seconds</li>
                        <li>‚úÖ Visual feedback with countdown display</li>
                        <li>‚úÖ Cancel redirect option available</li>
                        <li>‚úÖ Redirect starts 2 seconds after page load</li>
                        <li>‚úÖ Responsive design for mobile devices</li>
                        <li>‚úÖ Maintains existing manual navigation options</li>
                    </ul>
                    <p><strong>File Updated:</strong> <code>themes/default/views/auth/logout.php</code></p>
                </div>
            `;
        }
        
        function simulateRedirect() {
            const simulation = document.getElementById('logoutSimulation');
            const redirectNotice = document.getElementById('redirectNotice');
            
            // Show logout simulation
            simulation.style.display = 'block';
            
            // Start redirect after 2 seconds (like the real page)
            setTimeout(function() {
                redirectNotice.style.display = 'block';
                startCountdown();
            }, 2000);
        }
        
        function startCountdown() {
            const countdownElement = document.getElementById('countdown');
            
            countdownInterval = setInterval(function() {
                countdownTime--;
                countdownElement.textContent = countdownTime;
                
                if (countdownTime <= 0) {
                    clearInterval(countdownInterval);
                    document.getElementById('testOutput').innerHTML += `
                        <div class="success">
                            <h4>‚úÖ Redirect Simulation Complete</h4>
                            <p>Would redirect to homepage now!</p>
                        </div>
                    `;
                    document.getElementById('logoutSimulation').style.display = 'none';
                    resetSimulation();
                }
            }, 1000);
            
            redirectTimer = setTimeout(function() {
                // Simulate redirect (in real page, this would redirect to homepage)
                console.log('Redirecting to homepage...');
            }, 5000);
        }
        
        function cancelRedirect() {
            clearTimeout(redirectTimer);
            clearInterval(countdownInterval);
            document.getElementById('redirectNotice').style.display = 'none';
            
            document.getElementById('testOutput').innerHTML += `
                <div class="info">
                    <h4>‚èπÔ∏è Redirect Cancelled</h4>
                    <p>User successfully cancelled the auto-redirect!</p>
                </div>
            `;
            
            resetSimulation();
        }
        
        function resetSimulation() {
            countdownTime = 5;
            setTimeout(function() {
                document.getElementById('logoutSimulation').style.display = 'none';
            }, 3000);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîì Logout auto-redirect test page loaded');
        });
    </script>
</body>
</html>
